<!DOCTYPE html>
<html lang="zh-Hans">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="解衣又作茶瓜客，倚槛同看烟雨峰">
    

    <!--Author-->
    
        <meta name="author" content="茶瓜客">
    

    <!-- Title -->
    
    <title>OpenGL入门（六） | 茶瓜客</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Custom Fonts -->
    <link href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Noto+Serif:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- jQuery -->
    <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="//cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="茶瓜客" type="application/atom+xml">
</head>

<body>

    <!-- Content -->
    <section class="article-container">
    <!-- Back Home -->
    <a class="nav-back" href="/">
    <i class="fa fa-puzzle-piece"></i>
</a>

        <!-- Page Header -->
        <header class="intro-header">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <div class="post-heading">
                            <h1>
                                OpenGL入门（六）
                            </h1>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Post Content -->
        <article>
            <div class="container">
                <div class="row">
                    <!-- Post Main Content -->
                    <div class="post-content col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <p>基本光照</p>
<span id="more"></span>
<p><a target="_blank" rel="noopener" href="http://learnopengl.com/#!Lighting/Basic-Lighting">英文原文地址</a> <a target="_blank" rel="noopener" href="https://learnopengl-cn.github.io/02%20Lighting/02%20Basic%20Lighting/">中文翻译地址</a></p>
<h1 id="物体颜色"><a href="#物体颜色" class="headerlink" title="物体颜色"></a>物体颜色</h1><p>物体所呈现的颜色是因为物体吸收了光照的其他子颜色，反射了不被吸收的子颜色，所以物体看起来就是这个不被吸收的颜色。</p>
<p>在OpenGL中，我们将光照颜色和物体颜色作分量相乘，得到的就是物体在某种光照下最终的颜色：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">glm::vec3 lightColor(0.33f, 0.42f, 0.18f);</span><br><span class="line">glm::vec3 toyColor(1.0f, 0.5f, 0.31f);</span><br><span class="line">glm::vec3 result &#x3D; lightColor * toyColor; &#x2F;&#x2F; &#x3D; (0.33f, 0.21f, 0.06f);</span><br></pre></td></tr></table></figure>
<h1 id="基础光照"><a href="#基础光照" class="headerlink" title="基础光照"></a>基础光照</h1><p>下面基于冯氏光照模型（Phong Lighting Model）来学习基础光照的知识。</p>
<p>冯氏光照模型的主要结构由3个分量组成：环境(Ambient)、漫反射(Diffuse)和镜面(Specular)光照。下面这张图展示了这些光照分量看起来的样子：</p>
<p><img src="https://learnopengl-cn.github.io/img/02/02/basic_lighting_phong.png" alt=""></p>
<ul>
<li><p>环境光照(Ambient Lighting)：即使在黑暗的情况下，世界上通常也仍然有一些光亮（月亮、远处的光），所以物体几乎永远不会是完全黑暗的。为了模拟这个，我们会使用一个环境光照常量，它永远会给物体一些颜色。</p>
</li>
<li><p>漫反射光照(Diffuse Lighting)：模拟光源对物体的方向性影响(Directional Impact)。它是冯氏光照模型中视觉上最显著的分量。物体的某一部分越是正对着光源，它就会越亮。</p>
</li>
<li><p>镜面光照(Specular Lighting)：模拟有光泽物体上面出现的亮点。镜面光照的颜色相比于物体的颜色会更倾向于光的颜色。</p>
</li>
</ul>
<h2 id="环境光照"><a href="#环境光照" class="headerlink" title="环境光照"></a>环境光照</h2><p>全局照明（Global Illumination）算法非常复杂，现在使用简化的方式来实现环境光照——用一个简单的颜色，添加到物体片段的最终颜色中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">    float ambientStrength &#x3D; 0.1;</span><br><span class="line">    vec3 ambient &#x3D; ambientStrength * lightColor;</span><br><span class="line"></span><br><span class="line">    vec3 result &#x3D; ambient * objectColor;</span><br><span class="line">    FragColor &#x3D; vec4(result, 1.0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="漫反射光照"><a href="#漫反射光照" class="headerlink" title="漫反射光照"></a>漫反射光照</h2><p>漫反射光照使物体上与光线方向越接近的片段能从光源处获得更多的亮度。</p>
<p><img src="https://learnopengl-cn.github.io/img/02/02/diffuse_light.png" alt=""></p>
<p>如上图所示，垂直于片段表面的叫法向量（Normal Vector），根据光线与法向量的夹角决定光线对物体颜色的影响。夹角采用两个向量对应的单位向量的点乘结果作为与夹角对应的影响标量。</p>
<p><strong>法向量</strong></p>
<p>法向量是一个垂直有顶点表面的单位向量，是通过该顶点与周围的顶点叉乘计算得到的向量。</p>
<p>具体代码可以看<a target="_blank" rel="noopener" href="https://learnopengl.com/code_viewer_gh.php?code=src/2.lighting/2.1.basic_lighting_diffuse/basic_lighting_diffuse.cpp">这里</a>，输出结果如下：</p>
<p><img src="https://learnopengl-cn.github.io/img/02/02/basic_lighting_diffuse.png" alt=""></p>
<p><strong>法线矩阵</strong></p>
<p>物体的不等比缩放会破坏法向量，所以需要在顶点着色器上，使用函数<code>inverse</code>和<code>transpose</code>生成法线矩阵来处理法向量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Normal &#x3D; mat3(transpose(inverse(model))) * aNormal;</span><br></pre></td></tr></table></figure>
<h2 id="镜面光照"><a href="#镜面光照" class="headerlink" title="镜面光照"></a>镜面光照</h2><p>在漫反射光照中，没涉及到物体的反射，如下图，反射向量与视线的夹角决定了镜面光照的影响。</p>
<p><img src="https://learnopengl-cn.github.io/img/02/02/basic_lighting_specular_theory.png" alt=""></p>
<p><strong>反光度</strong></p>
<p>平常我们可以注意到，有些物体反光很厉害。这个在OpenGL中使用反光度来反映，通过对视线方向与反射方向的点乘结果取幂次数来决定：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">float spec &#x3D; pow(max(dot(viewDir, reflectDir), 0.0), 32);</span><br><span class="line">vec3 specular &#x3D; specularStrength * spec * lightColor;</span><br></pre></td></tr></table></figure>
<p>上面代码就是取32次幂，下面展示不同次幂的视觉效果：</p>
<p><img src="https://learnopengl-cn.github.io/img/02/02/basic_lighting_specular_shininess.png" alt=""></p>
<p>最终源码在<a target="_blank" rel="noopener" href="https://learnopengl.com/code_viewer_gh.php?code=src/2.lighting/2.2.basic_lighting_specular/basic_lighting_specular.cpp">这里</a>，输出如下：</p>
<p><img src="https://learnopengl-cn.github.io/img/02/02/basic_lighting_specular.png" alt=""></p>


                            <!-- Meta -->
                            <div class="post-meta">
                                <hr>
                                <br>
                                <div class="post-tags">
                                    
                                        

<a href="/tags/OpenGL入门/">#OpenGL入门</a>


                                            
                                </div>
                                <div class="post-date">
                                    
                                        2021-05-13
                                    
                                </div>
                            </div>
                    </div>

                    <!-- Comments -->
                    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                        <!-- Disqus Comments -->


                    </div>
                </div>
            </div>
        </article>
</section>

<!-- Image viewer-->

    <!-- Custom picture view-->
    <link href="/css/viewer.min.css" rel="stylesheet" />
    <script
      src="/js/viewer.min.js"
      type="text/javascript"
      charset="utf-8"
    ></script>
    
    <script type="text/javascript">
      // set image viewer
      Viewer.setDefaults({
        zoomRatio: [0.5],
        navbar: false,
        toolbar: false,
        button: false,
        title: [2, (image, imageData) => `${image.alt}`],
        show: function() {
          this.viewer.zoomTo(0.5);
        }
      });
      var imageList = document.getElementsByTagName("img");
      Array.prototype.forEach.call(imageList, element => {
        var viewer = new Viewer(element);
      });
    </script>

    

<!-- TOC -->

    <aside id="article-toc" role="navigation" class="fixed">
        <div id="article-toc-inner">
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%89%A9%E4%BD%93%E9%A2%9C%E8%89%B2"><span class="toc-text">物体颜色</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E5%85%89%E7%85%A7"><span class="toc-text">基础光照</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%85%89%E7%85%A7"><span class="toc-text">环境光照</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%AB%E5%8F%8D%E5%B0%84%E5%85%89%E7%85%A7"><span class="toc-text">漫反射光照</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%95%9C%E9%9D%A2%E5%85%89%E7%85%A7"><span class="toc-text">镜面光照</span></a></li></ol></li></ol>
        </div>
    </aside>

    <!-- Scripts -->
    <script type="text/javascript">
    console.log("© chaguake 🙋 2021-" + new Date().getFullYear());
</script>
  
    <!-- Google Analytics -->
    

    <!-- Service Worker -->
    <!-- if using service worker -->

    
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>

</html>